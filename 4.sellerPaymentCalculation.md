              ┌──────────────────────────────┐
              │ Lambda Trigger (Cron / API)  │
              └───────────────┬──────────────┘
                              │
                              ▼
           ┌────────────────────────────────────┐
           │ Load DB Credentials (SecretsMgr)    │
           └───────────────────┬────────────────┘
                               │
                               ▼
                 ┌────────────────────────┐
                 │ Determine Settlement    │
                 │ Date & Range           │
                 └───────────┬────────────┘
                             │
                             ▼
        ┌──────────────────────────────────────────┐
        │ Fetch Sales+Refund Data for Date Window   │
        └───────────────┬──────────────────────────┘
                        │
                        ▼
         ┌──────────────────────────────────────┐
         │ Group Records by Seller (Store Code) │
         └─────────────┬────────────────────────┘
                       │
                       ▼
     ┌──────────────────────────────────────────────┐
     │ For Each Seller: Compute totals, amounts, etc │
     └───────────────┬──────────────────────────────┘
                     │
                     │
         ┌───────────▼────────────────────┐
         │ Bank Info Missing?             │
         ├───────────┬────────────────────┘
         │ Yes        │ No
         ▼            ▼
 Add to Warning   ┌──────────────────────────────────┐
 Email List       │ Transfer Amount > 0 ?            │
                  ├────────────┬────────────────────┘
                  │ Yes         │ No
                  ▼             ▼
       ┌─────────────────┐   Add to Negative Billing
       │ Insert/Update   │   Email List (if < 0)
       │ ec_seller_payment│
       └─────────────────┘

              ▼
┌────────────────────────────────────┐
│ Insert ec_seller_receipt &         │
│ ec_sales_statement                 │
└────────────────────────────────────┘
              ▼
┌────────────────────────────────────┐
│ Update sales deposit status        │
└────────────────────────────────────┘
              ▼
┌────────────────────────────────────┐
│ Send Notification Emails           │
└────────────────────────────────────┘
              ▼
       ┌──────────────────────┐
       │ Return Execution Log │
       └──────────────────────┘
